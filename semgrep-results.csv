check_id,file,start_line,start_col,start_offset,severity,impact,message,references
"rules.generic.secrets.security.detected-jwt-token","/src/smspanel/.claude/settings.local.json",11,21,242,"ERROR","MEDIUM","JWT token detected","https://semgrep.dev/blog/2020/hardcoded-secrets-unverified-tokens-and-other-common-jwt-mistakes/"
"rules.generic.secrets.gitleaks.jwt","/src/smspanel/.claude/settings.local.json",11,21,242,"INFO","MEDIUM","A gitleaks jwt was detected which attempts to identify hard-coded credentials. It is not recommended to store credentials in source-code, as this risks secrets being leaked and used by either an internal or external malicious adversary. It is recommended to use environment variables to securely provide credentials or retrieve credentials from a secure vault or HSM (Hardware Security Module).","https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
"rules.generic.secrets.security.detected-ssh-password","/src/smspanel/.gitea/workflows/deploy_gnet.yaml",44,9,1103,"ERROR","MEDIUM","SSH Password detected","https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
"rules.generic.secrets.security.detected-sonarqube-docs-api-key","/src/smspanel/.gitea/workflows/deploy_gnet.yaml",46,170,1456,"ERROR","MEDIUM","SonarQube Docs API Key detected","https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
"rules.generic.secrets.security.detected-ssh-password","/src/smspanel/.gitea/workflows/deploy_gnet.yaml",51,9,1586,"ERROR","MEDIUM","SSH Password detected","https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
"rules.generic.secrets.security.detected-ssh-password","/src/smspanel/.gitea/workflows/deploy_gnet.yaml",62,9,2128,"ERROR","MEDIUM","SSH Password detected","https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
"rules.generic.secrets.security.detected-ssh-password","/src/smspanel/.gitea/workflows/deploy_gnet.yaml",89,9,3236,"ERROR","MEDIUM","SSH Password detected","https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
"rules.generic.secrets.security.detected-ssh-password","/src/smspanel/.gitea/workflows/deploy_gnet.yaml",92,9,3473,"ERROR","MEDIUM","SSH Password detected","https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures"
"rules.ai.generic.detect-generic-ai-anthprop","/src/smspanel/CLAUDE.md",3,45,59,"INFO",,"Possibly found usage of AI: Anthropic","https://semgrep.dev/blog/2024/detecting-shadow-ai"
"rules.dockerfile.audit.dockerfile-source-not-pinned","/src/smspanel/Dockerfile",1,1,0,"INFO",,"To ensure reproducible builds, pin Dockerfile `FROM` commands to a specific hash. You can find the hash by running `docker pull python` and then  specify it with `python:3.12-slim@sha256:<hash goes here>`","https://stackoverflow.com/a/33511811/4965"
"rules.dockerfile.security.secret-in-build-arg","/src/smspanel/Dockerfile",5,1,74,"WARNING","HIGH","Docker build time arguments are not suited for secrets, because the argument values are saved with the image. Running `docker image history` on the image will show information on how the image was built, including arguments. If these contain plain text secrets, anyone with access to the docker image can access those secrets and exploit them.","https://cwe.mitre.org/data/definitions/538.html; https://docs.docker.com/engine/reference/builder/#arg"
"rules.generic.secrets.gitleaks.generic-api-key","/src/smspanel/README.md",152,33,5765,"INFO","MEDIUM","A gitleaks generic-api-key was detected which attempts to identify hard-coded credentials.  It is not recommended to store credentials in source-code, as this risks secrets being leaked  and used by either an internal or external malicious adversary. It is recommended to use  environment variables to securely provide credentials or retrieve credentials from a  secure vault or HSM (Hardware Security Module). This rule can introduce a lot of false positives,  it is not recommended to be used in PR comments.","https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
"rules.python.django.security.audit.unvalidated-password","/src/smspanel/init_db.py",30,13,839,"WARNING","MEDIUM","The password on 'admin' is being set without validating the password. Call django.contrib.auth.password_validation.validate_password() with validation functions before setting the password. See https://docs.djangoproject.com/en/3.0/topics/auth/passwords/ for more information.","https://docs.djangoproject.com/en/3.0/topics/auth/passwords/#module-django.contrib.auth.password_validation"
"rules.python.lang.maintainability.is-function-without-parentheses","/src/smspanel/init_db.py",32,13,934,"WARNING",,"Is ""is_admin"" a function or an attribute? If it is a function, you may have meant admin.is_admin() because admin.is_admin is always true.",""
"rules.python.lang.maintainability.is-function-without-parentheses","/src/smspanel/init_db.py",33,13,969,"WARNING",,"Is ""is_active"" a function or an attribute? If it is a function, you may have meant admin.is_active() because admin.is_active is always true.",""
"rules.python.flask.security.audit.avoid_app_run_with_bad_host","/src/smspanel/run.py",18,5,525,"WARNING","MEDIUM","Running flask app with host 0.0.0.0 could expose the server publicly.","https://owasp.org/Top10/A01_2021-Broken_Access_Control"
"rules.python.flask.security.audit.avoid_app_run_with_bad_host","/src/smspanel/scripts/mock_sms_api.py",60,5,1713,"WARNING","MEDIUM","Running flask app with host 0.0.0.0 could expose the server publicly.","https://owasp.org/Top10/A01_2021-Broken_Access_Control"
"rules.generic.secrets.gitleaks.generic-api-key","/src/smspanel/scripts/test_api.sh",20,10,632,"INFO","MEDIUM","A gitleaks generic-api-key was detected which attempts to identify hard-coded credentials.  It is not recommended to store credentials in source-code, as this risks secrets being leaked  and used by either an internal or external malicious adversary. It is recommended to use  environment variables to securely provide credentials or retrieve credentials from a  secure vault or HSM (Hardware Security Module). This rule can introduce a lot of false positives,  it is not recommended to be used in PR comments.","https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html"
"rules.bash.lang.correctness.unquoted-variable-expansion-in-command","/src/smspanel/scripts/test_api.sh",25,3,755,"INFO",,"Variable expansions must be double-quoted so as to prevent being split into multiple pieces according to whitespace or whichever separator is specified by the IFS variable. If you really wish to split the variable's contents, you may use a variable that starts with an underscore e.g. $_X instead of $X, and semgrep will ignore it. If what you need is an array, consider using a proper bash array.",""
"rules.bash.lang.correctness.unquoted-variable-expansion-in-command","/src/smspanel/scripts/test_api.sh",33,3,1006,"INFO",,"Variable expansions must be double-quoted so as to prevent being split into multiple pieces according to whitespace or whichever separator is specified by the IFS variable. If you really wish to split the variable's contents, you may use a variable that starts with an underscore e.g. $_X instead of $X, and semgrep will ignore it. If what you need is an array, consider using a proper bash array.",""
"rules.bash.lang.correctness.unquoted-variable-expansion-in-command","/src/smspanel/scripts/test_api.sh",52,3,1572,"INFO",,"Variable expansions must be double-quoted so as to prevent being split into multiple pieces according to whitespace or whichever separator is specified by the IFS variable. If you really wish to split the variable's contents, you may use a variable that starts with an underscore e.g. $_X instead of $X, and semgrep will ignore it. If what you need is an array, consider using a proper bash array.",""
"rules.python.lang.best-practice.unspecified-open-encoding","/src/smspanel/src/smspanel/app.py",111,22,3688,"WARNING",,"Missing 'encoding' parameter. 'open()' uses device locale encodings by default, corrupting files with special characters. Specify the encoding to ensure cross-platform support when opening files in text mode (e.g. encoding=""utf-8"").","https://www.python.org/dev/peps/pep-0597/; https://docs.python.org/3/library/functions.html#open"
"rules.python.django.security.audit.unvalidated-password","/src/smspanel/src/smspanel/app.py",238,17,8201,"WARNING","MEDIUM","The password on 'admin' is being set without validating the password. Call django.contrib.auth.password_validation.validate_password() with validation functions before setting the password. See https://docs.djangoproject.com/en/3.0/topics/auth/passwords/ for more information.","https://docs.djangoproject.com/en/3.0/topics/auth/passwords/#module-django.contrib.auth.password_validation"
"rules.python.lang.maintainability.is-function-without-parentheses","/src/smspanel/src/smspanel/app.py",240,17,8306,"WARNING",,"Is ""is_admin"" a function or an attribute? If it is a function, you may have meant admin.is_admin() because admin.is_admin is always true.",""
"rules.python.lang.maintainability.is-function-without-parentheses","/src/smspanel/src/smspanel/app.py",241,17,8345,"WARNING",,"Is ""is_active"" a function or an attribute? If it is a function, you may have meant admin.is_active() because admin.is_active is always true.",""
"rules.python.lang.maintainability.return-not-in-function","/src/smspanel/src/smspanel/models.py",58,57,1659,"WARNING",,"`return` only makes sense inside a function",""
"rules.python.lang.maintainability.return-not-in-function","/src/smspanel/src/smspanel/models.py",97,57,3021,"WARNING",,"`return` only makes sense inside a function",""
"rules.python.lang.maintainability.return-not-in-function","/src/smspanel/src/smspanel/models.py",181,57,6275,"WARNING",,"`return` only makes sense inside a function",""
"rules.python.lang.maintainability.return-not-in-function","/src/smspanel/src/smspanel/services/db_queue.py",36,57,1057,"WARNING",,"`return` only makes sense inside a function",""
"rules.python.lang.best-practice.pass-body-fn","/src/smspanel/src/smspanel/services/queue.py",245,5,8998,"WARNING",,"`pass` is the body of function shutdown_workers. Consider removing this or raise NotImplementedError() if this is a TODO",""
"rules.python.django.security.django-no-csrf-token","/src/smspanel/src/smspanel/templates/admin/change_password.html",13,9,423,"WARNING","MEDIUM","Manually-created forms in django templates should specify a csrf_token to prevent CSRF attacks.","https://docs.djangoproject.com/en/4.2/howto/csrf/"
"rules.python.django.security.django-no-csrf-token","/src/smspanel/src/smspanel/templates/admin/dead_letter.html",52,9,1835,"WARNING","MEDIUM","Manually-created forms in django templates should specify a csrf_token to prevent CSRF attacks.","https://docs.djangoproject.com/en/4.2/howto/csrf/"
"rules.python.django.security.django-no-csrf-token","/src/smspanel/src/smspanel/templates/admin/dead_letter.html",91,25,3608,"WARNING","MEDIUM","Manually-created forms in django templates should specify a csrf_token to prevent CSRF attacks.","https://docs.djangoproject.com/en/4.2/howto/csrf/"
"rules.python.django.security.django-no-csrf-token","/src/smspanel/src/smspanel/templates/admin/dead_letter.html",98,25,4056,"WARNING","MEDIUM","Manually-created forms in django templates should specify a csrf_token to prevent CSRF attacks.","https://docs.djangoproject.com/en/4.2/howto/csrf/"
"rules.python.django.security.django-no-csrf-token","/src/smspanel/src/smspanel/templates/admin/delete_user.html",28,13,1046,"WARNING","MEDIUM","Manually-created forms in django templates should specify a csrf_token to prevent CSRF attacks.","https://docs.djangoproject.com/en/4.2/howto/csrf/"
"rules.generic.html-templates.security.unquoted-attribute-var","/src/smspanel/src/smspanel/templates/admin/messages.html",21,55,777,"WARNING","MEDIUM","Detected a unquoted template variable as an attribute. If unquoted, a malicious actor could inject custom JavaScript handlers. To fix this, add quotes around the template expression, like this: ""{{ expr }}"".","https://flask.palletsprojects.com/en/1.1.x/security/#cross-site-scripting-xss"
"rules.generic.html-templates.security.unquoted-attribute-var","/src/smspanel/src/smspanel/templates/admin/messages.html",32,49,1283,"WARNING","MEDIUM","Detected a unquoted template variable as an attribute. If unquoted, a malicious actor could inject custom JavaScript handlers. To fix this, add quotes around the template expression, like this: ""{{ expr }}"".","https://flask.palletsprojects.com/en/1.1.x/security/#cross-site-scripting-xss"
"rules.generic.html-templates.security.unquoted-attribute-var","/src/smspanel/src/smspanel/templates/admin/messages.html",33,46,1386,"WARNING","MEDIUM","Detected a unquoted template variable as an attribute. If unquoted, a malicious actor could inject custom JavaScript handlers. To fix this, add quotes around the template expression, like this: ""{{ expr }}"".","https://flask.palletsprojects.com/en/1.1.x/security/#cross-site-scripting-xss"
"rules.generic.html-templates.security.unquoted-attribute-var","/src/smspanel/src/smspanel/templates/admin/messages.html",34,48,1485,"WARNING","MEDIUM","Detected a unquoted template variable as an attribute. If unquoted, a malicious actor could inject custom JavaScript handlers. To fix this, add quotes around the template expression, like this: ""{{ expr }}"".","https://flask.palletsprojects.com/en/1.1.x/security/#cross-site-scripting-xss"
"rules.generic.html-templates.security.unquoted-attribute-var","/src/smspanel/src/smspanel/templates/admin/messages.html",35,49,1589,"WARNING","MEDIUM","Detected a unquoted template variable as an attribute. If unquoted, a malicious actor could inject custom JavaScript handlers. To fix this, add quotes around the template expression, like this: ""{{ expr }}"".","https://flask.palletsprojects.com/en/1.1.x/security/#cross-site-scripting-xss"
"rules.python.django.security.django-no-csrf-token","/src/smspanel/src/smspanel/templates/admin/users.html",55,41,2758,"WARNING","MEDIUM","Manually-created forms in django templates should specify a csrf_token to prevent CSRF attacks.","https://docs.djangoproject.com/en/4.2/howto/csrf/"
"rules.python.django.security.django-no-csrf-token","/src/smspanel/src/smspanel/templates/admin/users.html",63,37,3576,"WARNING","MEDIUM","Manually-created forms in django templates should specify a csrf_token to prevent CSRF attacks.","https://docs.djangoproject.com/en/4.2/howto/csrf/"
"rules.python.django.security.django-no-csrf-token","/src/smspanel/src/smspanel/templates/login.html",8,5,162,"WARNING","MEDIUM","Manually-created forms in django templates should specify a csrf_token to prevent CSRF attacks.","https://docs.djangoproject.com/en/4.2/howto/csrf/"
"rules.python.django.security.django-no-csrf-token","/src/smspanel/src/smspanel/templates/register.html",8,5,168,"WARNING","MEDIUM","Manually-created forms in django templates should specify a csrf_token to prevent CSRF attacks.","https://docs.djangoproject.com/en/4.2/howto/csrf/"
"rules.python.lang.security.audit.logging.python-logger-credential-disclosure","/src/smspanel/src/smspanel/utils/rate_limiter.py",132,5,4163,"WARNING","MEDIUM","Detected a python logger call with a potential hardcoded secret ""Rate limiter initialized: rate=%.1f tokens/sec, burst=%s"" being logged. This may lead to secret credentials being exposed. Make sure that the logger is not logging  sensitive information.","https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures"
"rules.python.lang.maintainability.is-function-without-parentheses","/src/smspanel/src/smspanel/web/admin.py",38,16,1051,"WARNING",,"Is ""is_authenticated"" a function or an attribute? If it is a function, you may have meant current_user.is_authenticated() because current_user.is_authenticated is always true.",""
"rules.python.lang.maintainability.is-function-without-parentheses","/src/smspanel/src/smspanel/web/admin.py",41,16,1207,"WARNING",,"Is ""is_admin"" a function or an attribute? If it is a function, you may have meant current_user.is_admin() because current_user.is_admin is always true.",""
"rules.python.lang.maintainability.is-function-without-parentheses","/src/smspanel/src/smspanel/web/admin.py",55,33,1618,"WARNING",,"Is ""is_admin"" a function or an attribute? If it is a function, you may have meant User.is_admin() because User.is_admin is always true.",""
"rules.python.django.security.audit.unvalidated-password","/src/smspanel/src/smspanel/web/admin.py",83,9,2715,"WARNING","MEDIUM","The password on 'user' is being set without validating the password. Call django.contrib.auth.password_validation.validate_password() with validation functions before setting the password. See https://docs.djangoproject.com/en/3.0/topics/auth/passwords/ for more information.","https://docs.djangoproject.com/en/3.0/topics/auth/passwords/#module-django.contrib.auth.password_validation"
"rules.python.lang.maintainability.is-function-without-parentheses","/src/smspanel/src/smspanel/web/admin.py",85,9,2796,"WARNING",,"Is ""is_admin"" a function or an attribute? If it is a function, you may have meant user.is_admin() because user.is_admin is always true.",""
"rules.python.lang.maintainability.is-function-without-parentheses","/src/smspanel/src/smspanel/web/admin.py",86,9,2830,"WARNING",,"Is ""is_active"" a function or an attribute? If it is a function, you may have meant user.is_active() because user.is_active is always true.",""
"rules.python.django.security.audit.unvalidated-password","/src/smspanel/src/smspanel/web/admin.py",118,9,3933,"WARNING","MEDIUM","The password on 'user' is being set without validating the password. Call django.contrib.auth.password_validation.validate_password() with validation functions before setting the password. See https://docs.djangoproject.com/en/3.0/topics/auth/passwords/ for more information.","https://docs.djangoproject.com/en/3.0/topics/auth/passwords/#module-django.contrib.auth.password_validation"
"rules.python.lang.maintainability.is-function-without-parentheses","/src/smspanel/src/smspanel/web/admin.py",142,5,4715,"WARNING",,"Is ""is_active"" a function or an attribute? If it is a function, you may have meant user.is_active() because user.is_active is always true.",""
"rules.python.lang.maintainability.is-function-without-parentheses","/src/smspanel/src/smspanel/web/admin.py",142,26,4736,"WARNING",,"Is ""is_active"" a function or an attribute? If it is a function, you may have meant user.is_active() because user.is_active is always true.",""
"rules.python.lang.maintainability.is-function-without-parentheses","/src/smspanel/src/smspanel/web/admin.py",146,31,4850,"WARNING",,"Is ""is_active"" a function or an attribute? If it is a function, you may have meant user.is_active() because user.is_active is always true.",""
"rules.python.lang.maintainability.is-function-without-parentheses","/src/smspanel/src/smspanel/web/admin_messages.py",17,12,515,"WARNING",,"Is ""is_admin"" a function or an attribute? If it is a function, you may have meant current_user.is_admin() because current_user.is_admin is always true.",""
"rules.python.flask.security.open-redirect","/src/smspanel/src/smspanel/web/auth.py",40,9,1237,"ERROR","MEDIUM","Data from request is passed to redirect(). This is an open redirect and could be exploited. Consider using 'url_for()' to generate links to known locations. If you must use a URL to unknown pages, consider using 'urlparse()' or similar and checking if the 'netloc' property is the same as your site's host name. See the references for more information.","https://flask-login.readthedocs.io/en/latest/#login-example; https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html#dangerous-url-redirect-example-1; https://docs.python.org/3/library/urllib.parse.html#url-parsing"
"rules.python.lang.maintainability.is-function-without-parentheses","/src/smspanel/src/smspanel/web/dead_letter.py",21,16,633,"WARNING",,"Is ""is_authenticated"" a function or an attribute? If it is a function, you may have meant current_user.is_authenticated() because current_user.is_authenticated is always true.",""
"rules.python.lang.maintainability.is-function-without-parentheses","/src/smspanel/src/smspanel/web/dead_letter.py",24,16,789,"WARNING",,"Is ""is_admin"" a function or an attribute? If it is a function, you may have meant current_user.is_admin() because current_user.is_admin is always true.",""
